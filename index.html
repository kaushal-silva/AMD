<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AMD Portal | Airway Mouth Doctor Solutions</title>
    <!-- Load Tailwind CSS CDN for modern, responsive styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Use Inter font family for a clean, professional look -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* Light off-white/blue background */
        }
        .bg-gradient-amd {
            /* A soothing blue-green gradient theme for health and airway */
            background-image: linear-gradient(to right bottom, #10b981, #06b6d4);
        }
        .flow-step {
            @apply mb-6; /* Removed flex items-center */
        }
        .flow-step-content {
            @apply pl-14; /* Add padding to align text with icon */
        }
        .flow-step-icon {
            @apply flex items-center justify-center w-10 h-10 bg-sky-500 text-white rounded-full font-bold text-lg shadow-lg flex-shrink-0 absolute top-0 left-0;
        }
        .flow-step-line {
            /* Adjusted height to use a fixed pixel value so it correctly connects all 6 steps regardless of varying content height */
            height: calc(100% - 10px); 
            @apply w-px bg-sky-300 absolute left-5 top-5; /* Adjusted top for alignment */
        }
        .flow-container {
            @apply relative;
        }
        /* Custom modal animation */
        .modal-fade-enter {
            opacity: 0;
            transform: scale(0.95);
        }
        .modal-fade-enter-active {
            opacity: 1;
            transform: scale(1);
            transition: opacity 200ms ease-out, transform 200ms ease-out;
        }
    </style>
</head>
<body>

    <!-- Main Application Container -->
    <div class="min-h-screen flex flex-col p-4 relative">

        <!-- Header: Language Toggle and Professional Login Dropdown -->
        <header class="w-full max-w-7xl mx-auto flex justify-between items-center py-4 px-2 sticky top-0 bg-f8fafc z-20">
            <h1 class="text-2xl font-extrabold text-gray-900">
                <span class="bg-gradient-amd bg-clip-text text-transparent">AMD</span>
            </h1>

            <div class="flex items-center space-x-4">
                <!-- Language Toggle Button -->
                <button id="lang-toggle" onclick="toggleLanguage()" class="py-2 px-4 rounded-full bg-white text-teal-600 border border-teal-600 hover:bg-teal-50 transition duration-150 font-semibold shadow-md text-sm">
                    <!-- Text updated by JavaScript -->
                </button>

                <!-- Professional Login Dropdown -->
                <div class="relative" onmouseleave="closeDropdown()">
                    <button id="professionals-dropdown-btn" onclick="toggleDropdown()" class="py-2 px-4 bg-gray-600 text-white font-semibold rounded-lg hover:bg-gray-700 transition duration-150 text-sm shadow">
                        <span data-key="professionals_dropdown_text">Professionals Login</span>
                    </button>
                    <div id="professionals-dropdown-menu" class="absolute right-0 mt-2 w-56 origin-top-right bg-white rounded-md shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none hidden" role="menu" aria-orientation="vertical" aria-labelledby="professionals-dropdown-btn">
                        <div class="py-1" role="none">
                            <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-teal-50" role="menuitem" onclick="directLogin('Health Professional', 'PractitionerDashboard.html', event)" data-key="hp_dropdown_link">Health Practitioner</a>
                            <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-teal-50" role="menuitem" onclick="directLogin('AMC', 'AMCDashboard.html', event)" data-key="amc_dropdown_link">AMC (Admin)</a>
                            <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-teal-50" role="menuitem" onclick="directLogin('Consultant', 'ProfessionalConsultantDashboard.html', event)" data-key="consultant_dropdown_link">Professional Consultant</a>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content Area -->
        <main class="w-full max-w-7xl mx-auto flex-grow pt-4">

            <!-- Informative Section -->
            <section class="text-center mb-16 max-w-4xl mx-auto">
                <h2 class="text-4xl font-extrabold text-gray-900 sm:text-5xl tracking-tight" data-key="main_headline">
                    Resolving <span class="text-sky-600">Impaired Mouth Syndrome (IMS)</span> Holistically.
                </h2>
                <p class="mt-4 text-lg text-gray-700" data-key="main_mission">
                    Our platform is the sole gateway in Taiwan to receive treatment and consultation from the patent-holding specialist, **Dr. Felix (USA)**, in collaboration with a network of certified local Taiwanese dentists.
                </p>
                <p class="mt-2 text-lg text-gray-500" data-key="main_promise">
                    We provide a single, coordinated platform to manage your personalized journey toward improved breathing, posture, and holistic health.
                </p>
            </section>

            <div class="lg:grid lg:grid-cols-2 gap-12 items-start">
                
                <!-- LEFT COLUMN: Patient Journey Flowchart (UPDATED CONTENT) -->
                <section class="section-card bg-white p-8 rounded-xl shadow-lg">
                    <h3 class="text-2xl font-bold text-gray-800 mb-6 border-b pb-2 text-sky-600" data-key="flow_title">The Personalized Path to Your Best Health</h3>
                    
                    <!-- Flowchart Image -->
                    <div class="mb-8 text-center">
                        <img 
                            src="images/index/PatientFlowChart.png" 
                            alt="6-Step Patient Journey Flowchart: Enroll, Select Expert, Diagnostics, Confirm Diagnosis, Prescribe Solution, Full Support" 
                            class="w-full h-auto max-w-lg mx-auto rounded-lg shadow-md"
                            onerror="this.onerror=null;this.src='https://placehold.co/600x200/c7f2f2/06b6d4?text=Patient+Flowchart';"
                        >
                    </div>

                    <div class="flow-container pl-4 pb-4">
                        <!-- Vertical Line (Stretches from after the first icon to before the last step) -->
                        <div class="flow-step-line"></div> 

                        <!-- Step 1 -->
                        <div class="flow-step relative">
                            <div class="flow-step-icon">1</div>
                            <div class="flow-step-content" data-key="flow_step_1">
                                <p class="font-extrabold text-gray-800" data-key="flow_step_1_bold">Enroll and Access</p>
                                <p class="text-sm text-gray-700 mt-1" data-key="flow_step_1_desc">Sign up on our dedicated platform to officially enroll and gain immediate access to your personalized treatment planning tools.</p>
                            </div>
                        </div>

                        <!-- Step 2 -->
                        <div class="flow-step relative">
                            <div class="flow-step-icon">2</div>
                            <div class="flow-step-content" data-key="flow_step_2">
                                <p class="font-extrabold text-gray-800" data-key="flow_step_2_bold">Select Your Expert</p>
                                <p class="text-sm text-gray-700 mt-1" data-key="flow_step_2_desc">Choose a local Taiwanese dentist from our network who will serve as your treatment leader and clinical guide throughout your journey.</p>
                            </div>
                        </div>
                        
                        <!-- Step 3 -->
                        <div class="flow-step relative">
                            <div class="flow-step-icon">3</div>
                            <div class="flow-step-content" data-key="flow_step_3">
                                <p class="font-extrabold text-gray-800" data-key="flow_step_3_bold">Initiate Diagnostics</p>
                                <p class="text-sm text-gray-700 mt-1" data-key="flow_step_3_desc">Receive clear referrals and precise details for the initial scans required to establish your comprehensive medical diagnosis.</p>
                            </div>
                        </div>
                        
                        <!-- Step 4 -->
                        <div class="flow-step relative">
                            <div class="flow-step-icon">4</div>
                            <div class="flow-step-content" data-key="flow_step_4">
                                <p class="font-extrabold text-gray-800" data-key="flow_step_4_bold">Confirm Your Diagnosis</p>
                                <p class="text-sm text-gray-700 mt-1" data-key="flow_step_4_desc">Attend an in-person consultation with your dentist. Here, your local expert and our Airway Mouth Doctor (Dr. Felix) will confirm your IMS diagnosis (Integrated Mouth System) and collaboratively determine the precise treatment protocol you need, or confirm if treatment is not currently required.</p>
                            </div>
                        </div>
                         
                        <!-- Step 5 -->
                        <div class="flow-step relative">
                            <div class="flow-step-icon">5</div>
                            <div class="flow-step-content" data-key="flow_step_5">
                                <p class="font-extrabold text-gray-800" data-key="flow_step_5_bold">Custom Solution Prescribed</p>
                                <p class="text-sm text-gray-700 mt-1" data-key="flow_step_5_desc">Upon diagnosis confirmation, you will receive your individually engineered Start Thriving Appliance™ and an accompanying nutritional regimen—the foundational elements for your therapeutic success.</p>
                            </div>
                        </div>

                        <!-- Step 6 (Final Step - line should end before here) -->
                        <div class="flow-step relative">
                            <div class="flow-step-icon">6</div>
                            <div class="flow-step-content" data-key="flow_step_6">
                                <p class="font-extrabold text-gray-800" data-key="flow_step_6_bold">Full Clinical Support</p>
                                <p class="text-sm text-gray-700 mt-1" data-key="flow_step_6_desc">Throughout your treatment, you will work closely with your Doctor, specialized Airway Mouth Coordinator, and clinic team to ensure systematic progress toward your measurable health objectives.</p>
                            </div>
                        </div>
                        
                    </div>
                </section>

                <!-- RIGHT COLUMN: Client Login (Big and Central) -->
                <section class="flex flex-col items-center justify-center p-8 lg:p-0">
                    <div id="client-login-card" class="card-shadow bg-white p-8 rounded-xl border-t-4 border-sky-500 flex flex-col items-center text-center w-full max-w-sm">
                        <div class="text-6xl text-sky-500 mb-4" role="img" aria-label="Person icon">
                            <svg class="w-12 h-12" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21v-2a4 4 0 00-4-4H9a4 4 0 00-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
                        </div>
                        <h3 class="text-3xl font-bold text-gray-800 mb-2" data-key="client_card_title">Client / Patient Access</h3>
                        <p class="text-gray-500 mb-6" data-key="client_card_desc">
                            Begin your journey, sign in, or view your records and progress.
                        </p>
                        <button class="w-full py-3 px-6 bg-sky-600 text-white font-extrabold text-lg rounded-lg hover:bg-sky-700 transition duration-150" onclick="openLoginModal('Client')">
                            <span data-key="client_card_button">Start My Treatment Journey</span>
                        </button>
                    </div>
                </section>
            </div>
            
            <!-- NEW SECTION: Independent Clinic File Upload -->
            <section class="w-full max-w-6xl mx-auto mt-16">
                <div class="bg-gray-100 p-6 rounded-xl border border-gray-300 flex flex-col md:flex-row items-center justify-between shadow-md">
                    <div class="text-lg font-semibold text-gray-700 mb-4 md:mb-0" data-key="clinic_upload_title">
                        Independent Clinic: Secure Scan Upload (INV File)
                    </div>
                    <button class="py-2 px-4 bg-teal-600 text-white font-semibold rounded-lg hover:bg-teal-700 transition duration-150 text-sm w-full md:w-auto" onclick="openUploadModal()">
                        <span data-key="clinic_upload_button">Upload Patient INV File</span>
                    </button>
                </div>
            </section>

        </main>
    </div>

    <!-- Login Modal Structure (Shared for Client/Patient only) -->
    <div id="login-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50 hidden transition-opacity duration-300">
        <!-- Modal Content -->
        <div id="modal-content-container" class="bg-white w-full max-w-sm p-8 rounded-xl shadow-2xl relative modal-fade-enter">
            <!-- Close Button -->
            <button onclick="closeModal('login-modal')" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600 focus:outline-none">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
            </button>

            <h3 id="modal-title" class="text-2xl font-bold text-gray-800 mb-2 text-center"></h3>
            <p id="modal-subtitle" class="text-sm text-gray-500 mb-6 text-center"></p>

            <!-- Tab/Toggle for Sign In / Sign Up -->
            <div class="flex justify-center mb-8 bg-gray-100 p-1 rounded-lg">
                <button id="tab-signin" onclick="setMode('signin')" class="py-2 px-4 w-1/2 rounded-lg font-semibold text-gray-700 hover:text-gray-900 transition duration-150"></button>
                <button id="tab-signup" onclick="setMode('signup')" class="py-2 px-4 w-1/2 rounded-lg font-semibold text-gray-700 hover:text-gray-900 transition duration-150"></button>
            </div>

            <!-- Authentication Options -->
            <div class="space-y-4">
                <!-- Email/Password Mock -->
                <button id="auth-email" onclick="simulateLogin('email')" class="w-full flex items-center justify-center p-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition duration-150">
                    <svg class="w-5 h-5 mr-2 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8m-8 12a9 9 0 110-18 9 9 0 010 18z"/></svg>
                    <span id="auth-email-text" class="text-gray-700 font-medium"></span>
                </button>

                <!-- Line Mock (Using a simple icon and a brand color) -->
                <button id="auth-line" onclick="simulateLogin('line')" class="w-full flex items-center justify-center p-3 bg-[#00C300] text-white font-semibold rounded-lg hover:bg-[#00A000] transition duration-150">
                    <svg class="w-5 h-5 mr-2" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="24" cy="24" r="24" fill="#FFF"/><path fill="#00C300" d="M12.91 14.509h18.179v1.94h-18.179zM12.91 21.018h18.179v1.94h-18.179zM12.91 27.527h18.179v1.94h-18.179zM12.91 34.036h18.179v1.94h-18.179z"/></svg>
                    <span id="auth-line-text"></span>
                </button>
            </div>
        </div>
    </div>

    <!-- NEW MODAL: Clinic INV File Upload -->
    <div id="upload-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50 hidden transition-opacity duration-300">
        <!-- Modal Content -->
        <div id="upload-modal-content" class="bg-white w-full max-w-md p-8 rounded-xl shadow-2xl relative modal-fade-enter">
            <button onclick="closeModal('upload-modal')" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600 focus:outline-none">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
            </button>

            <h3 class="text-2xl font-bold text-teal-600 mb-4" data-key="upload_modal_title">Secure INV File Upload</h3>
            
            <form id="clinic-upload-form" class="space-y-4">
                
                <div class="p-3 bg-red-50 border border-red-200 rounded-lg">
                    <p class="font-bold text-red-700 text-sm mb-1" data-key="upload_note_heading">Security Note:</p>
                    <p class="text-xs text-red-600" data-key="upload_note_text">The file will be stored encrypted under the Patient ID until authorized for access by the patient, who will be notified upon receipt.</p>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1" data-key="patient_code_label">Unique Patient Code (e.g., AMDTW001)</label>
                    <input type="text" id="patient-code" placeholder="8 alphanumeric characters" class="w-full p-2 border border-gray-300 rounded-lg" required pattern="[A-Z0-9]{8}" maxlength="8">
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1" data-key="file_upload_label">INV File Upload (.inv, .dicom, etc.)</label>
                    <input type="file" id="inv-file" class="w-full p-2 border border-gray-300 rounded-lg" accept=".inv,.dcm,.dicom" required>
                </div>
                
                <hr class="border-gray-200">

                <p class="text-sm font-medium text-gray-700" data-key="clinic_details_optional">Clinic Details (Optional)</p>

                <div>
                    <input type="text" id="clinic-name" placeholder="Clinic Name" class="w-full p-2 border border-gray-300 rounded-lg">
                </div>
                <div>
                    <input type="email" id="clinic-email" placeholder="Clinic Email Address" class="w-full p-2 border border-gray-300 rounded-lg">
                </div>
                
                <div class="flex justify-end space-x-4 pt-2">
                    <button type="button" onclick="closeModal('upload-modal')" class="py-2 px-4 bg-gray-300 text-gray-800 rounded-lg hover:bg-gray-400" data-key="btn_cancel">Cancel</button>
                    <button type="submit" class="py-2 px-4 bg-teal-600 text-white rounded-lg hover:bg-teal-700 font-semibold" data-key="btn_submit_upload">Submit Secure Upload</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Message Box for Login Simulation -->
    <div id="message-box" class="fixed bottom-4 right-4 bg-white border-l-4 border-teal-500 text-gray-800 p-4 rounded-lg shadow-xl hidden transition-opacity duration-300" role="alert">
        <p id="message-text" class="font-semibold"></p>
    </div>

    <!-- JavaScript for translations and simulated login action -->
    <script>
        // --- Global Constants (FIXED: Declared only once) ---
        const currentLang = 'en'; // Default language
        const monthsCompleted = 6;
        const totalPrescriptionMonths = 24;
        const percentageCompleted = Math.round((monthsCompleted / totalPrescriptionMonths) * 100);

        // --- Appliance Timeline Logic (Mock Data) ---
        const applianceAdjustments = [
            { month: 0, setKey: 'state_m0_set', expansion: '0.0mm', date: '2025/09/20', noteKey: 'note_m0', clinicalDate: '2025/09/20', clinicalNoteKey: 'note_clinical_m0' },
            { month: 2, setKey: 'state_m2_set', expansion: '1.0 Turns / 0.38mm', date: '2025/11/20', noteKey: 'note_m2', clinicalDate: '2025/11/15', clinicalNoteKey: 'note_clinical_m2' },
            { month: 4, setKey: 'state_m4_set', expansion: '1.5 Turns / 0.45mm', date: '2026/01/01', noteKey: 'note_m4', clinicalDate: '2025/12/28', clinicalNoteKey: 'note_clinical_m4' },
            { month: 6, setKey: 'state_m6_set', expansion: '2.0 Turns / 0.50mm', date: '2026/03/20', noteKey: 'note_m6', clinicalDate: '2026/03/15', clinicalNoteKey: 'note_clinical_m6' }
        ];

        // --- Core Functions (FIXED: Defined globally) ---

        function toggleLanguage() {
            currentLang = currentLang === 'en' ? 'zh' : 'en';
            updateText();
        }

        function toggleDropdown() {
            const menu = document.getElementById('professionals-dropdown-menu');
            menu.classList.toggle('hidden');
        }

        function closeDropdown() {
             const menu = document.getElementById('professionals-dropdown-menu');
             setTimeout(() => {
                 if (!menu.matches(':hover')) {
                     menu.classList.add('hidden');
                 }
             }, 300);
        }
        
        function openUploadModal() {
            const modal = document.getElementById('upload-modal');
            const modalContent = document.getElementById('upload-modal-content');
            
            // Clear inputs and set initial state
            document.getElementById('clinic-upload-form').reset();
            
            modal.classList.remove('hidden');
            setTimeout(() => {
                modalContent.classList.remove('modal-fade-enter');
                modalContent.classList.add('modal-fade-enter-active');
            }, 10);
            
             // Handle form submission inside the modal
            document.getElementById('clinic-upload-form').onsubmit = function(event) {
                event.preventDefault();
                const patientCode = document.getElementById('patient-code').value;
                const fileName = document.getElementById('inv-file').files[0].name;

                closeModal('upload-modal');
                
                const message = currentLang === 'en' ? 
                    `Success! INV file '${fileName}' submitted for Patient ID ${patientCode}. The patient will be notified.` :
                    `成功！ INV 文件 '${fileName}' 已提交給患者 ID ${patientCode}。患者將收到通知。`;
                
                showMessage(message, 'Clinic');
            };
        }


        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            const modalContent = document.getElementById(modalId + '-content');
            
            if (!modal || !modalContent) return;

            modalContent.classList.remove('modal-fade-enter-active');
            modalContent.classList.add('modal-fade-enter');
            
            setTimeout(() => {
                modal.classList.add('hidden');
            }, 200);
        }


        function directLogin(userType, targetUrl, event) {
            event.preventDefault();
            closeDropdown();
            simulateRedirect(userType, 'signin', targetUrl);
        }

        function openLoginModal(userType) {
            currentUserType = userType;
            currentMode = 'signin';
            
            const modal = document.getElementById('login-modal');
            const modalContent = document.getElementById('modal-content-container');
            
            modal.classList.remove('hidden');
            setTimeout(() => {
                modalContent.classList.remove('modal-fade-enter');
                modalContent.classList.add('modal-fade-enter-active');
            }, 10); 
            
            setModalContent();
        }
        
        function setMode(mode) {
            currentMode = mode;
            setModalContent();
        }
        
        function setModalContent() {
            const langData = translations[currentLang];
            const isSignIn = currentMode === 'signin';
            
            document.getElementById('modal-title').textContent = isSignIn ? langData.modal_sign_in_title : langData.modal_sign_up_title;
            document.getElementById('modal-subtitle').textContent = langData.modal_subtitle_client;

            const tabSignIn = document.getElementById('tab-signin');
            const tabSignUp = document.getElementById('tab-signup');
            
            tabSignIn.textContent = langData.tab_sign_in;
            tabSignUp.textContent = langData.tab_sign_up;

            const activeClasses = 'bg-white text-gray-900 shadow';
            const inactiveClasses = 'bg-gray-100 text-gray-500 hover:bg-white';

            if (isSignIn) {
                tabSignIn.className = tabSignIn.className.replace(inactiveClasses, activeClasses);
                tabSignUp.className = tabSignUp.className.replace(activeClasses, inactiveClasses);
            } else {
                tabSignIn.className = tabSignIn.className.replace(activeClasses, inactiveClasses);
                tabSignUp.className = tabSignUp.className.replace(inactiveClasses, activeClasses);
            }
            
            document.getElementById('auth-email-text').textContent = isSignIn ? langData.auth_email_text : langData.auth_email_text.replace('Continue', 'Sign Up');
            document.getElementById('auth-line-text').textContent = isSignIn ? langData.auth_line_text : langData.auth_line_text.replace('Continue', 'Sign Up');
        }


        function simulateLogin(authMethod) {
            closeModal('login-modal');
            const isSignUp = currentMode === 'signup';
            let targetUrl = isSignUp ? 'ClientOnboarding.html' : 'ClientDashboard.html'; 
            
            simulateRedirect('Client', currentMode, targetUrl, authMethod);
        }

        function simulateRedirect(userType, mode, targetUrl, authMethod = 'N/A') {
            const actionText = mode === 'signup' ? translations[currentLang]['modal_sign_up_title'] : translations[currentLang]['modal_sign_in_title'];
            const userTypeText = translations[currentLang][userType.toLowerCase() + '_dropdown_link'] || userType;
            const methodText = authMethod !== 'N/A' ? (authMethod === 'email' ? (currentLang === 'en' ? 'Email/Password' : '電子郵件/密碼') : 'LINE') : '';
            
            const message = `${userTypeText} ${actionText} via ${methodText}. Redirecting to ${targetUrl}...`;
            
            showMessage(message, userType);

            setTimeout(() => {
                 window.location.href = targetUrl;
            }, 500); 
        }

        function showMessage(text, userType) {
            const messageBox = document.getElementById('message-box');
            const messageText = document.getElementById('message-text');
            
            messageText.textContent = text;
            
            let borderColorClass = 'border-teal-500'; 
            if (userType === 'Client') borderColorClass = 'border-sky-500';
            else if (userType === 'AMC') borderColorClass = 'border-indigo-500';
            else if (userType === 'Consultant' || userType === 'Health Professional') borderColorClass = 'border-teal-500';
            
            messageBox.className = `fixed bottom-4 right-4 bg-white border-l-4 ${borderColorClass} text-gray-800 p-4 rounded-lg shadow-xl transition-opacity duration-300`;
            messageBox.classList.remove('hidden');
            messageBox.style.opacity = '1';

            setTimeout(() => {
                messageBox.style.opacity = '0';
                setTimeout(() => {
                    messageBox.classList.add('hidden');
                }, 300); 
            }, 4000);
        }


        function updateText() {
            const langData = translations[currentLang];
            
            document.querySelectorAll('[data-key]').forEach(element => {
                const key = element.getAttribute('data-key');
                const boldKey = key + '_bold';
                const descKey = key + '_desc';

                if (langData[boldKey] && langData[descKey] && element.classList.contains('flow-step-content')) {
                    element.innerHTML = `
                        <p class="font-extrabold text-gray-800">${langData[boldKey]}</p>
                        <p class="text-sm text-gray-700 mt-1">${langData[descKey]}</p>
                    `;
                } else if (langData[key]) {
                    element.textContent = langData[key];
                }
            });

            const toggleButton = document.getElementById('lang-toggle');
            toggleButton.textContent = langData.toggle_text;

            document.documentElement.setAttribute('lang', currentLang);
            document.title = (currentLang === 'en' ? 'AMD Portal' : 'AMD 入口網站') + ' | Airway Mouth Doctor Solutions';
            
            if (!document.getElementById('login-modal').classList.contains('hidden')) {
                setModalContent();
            }
        }

        // Initialize the page with the default language
        document.addEventListener('DOMContentLoaded', updateText);
    </script>
</body>
</html>
