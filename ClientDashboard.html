<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AMD Client Dashboard | Tabbed View</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f1f5f9;
        }
        .section-card {
            background-color: white;
            padding: 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.06);
        }
        .alert-red {
            background-color: #fef2f2;
            border-left: 4px solid #ef4444;
            color: #b91c1c;
        }
        .chat-client {
            background-color: #dbeafe; /* Blue 100 */
            align-self: flex-end;
        }
        .chat-doctor {
            background-color: #ecfdf5; /* Teal 100 */
            align-self: flex-start;
        }
        .chat-amc {
            background-color: #f3e8ff; /* Indigo 100 */
            align-self: flex-start;
        }
        .tab-button {
            padding: 0.75rem 1rem;
            text-align: left;
            font-weight: 600;
            color: #4b5563;
            border-radius: 0.5rem;
            transition: all 0.15s ease;
        }
        .tab-button.active {
            background-color: #e0f2fe; /* Sky 100 */
            color: #0369a1; /* Sky 700 */
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            border-right: 3px solid #0ea5e9;
        }
        .tab-button:not(.active):hover {
            background-color: #f3f4f6;
        }
        /* Custom styling for the range input thumb */
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            height: 16px;
            width: 16px;
            border-radius: 50%;
            background: #0ea5e9;
            cursor: pointer;
            margin-top: -7px; 
            box-shadow: 0 0 4px rgba(0, 0, 0, 0.3);
        }
        .metric-card {
            @apply bg-white p-4 rounded-lg shadow-sm border border-gray-100;
        }
        .share-banner {
            background: linear-gradient(135deg, #0ea5e9 0%, #2dd4bf 100%);
        }
        .platform-btn {
            @apply flex flex-col items-center justify-center p-4 border rounded-xl hover:bg-slate-50 transition-all cursor-pointer;
        }
        .platform-btn.selected {
            @apply border-sky-500 bg-sky-50 ring-2 ring-sky-200;
        }
    </style>
</head>
<body>

    <div class="min-h-screen">
        <!-- Header -->
        <header class="bg-sky-600 shadow-md">
            <div class="max-w-7xl mx-auto py-4 px-4 sm:px-6 lg:px-8 flex justify-between items-center">
                <h1 id="header-title" class="text-3xl font-bold text-white" data-key="header_title">AMD Client Dashboard</h1>
                <div class="flex items-center space-x-4">
                    <!-- Language Toggle Button -->
                    <button id="lang-toggle" onclick="toggleLanguage()" class="py-1 px-3 rounded-full bg-white text-sky-700 border border-sky-500 hover:bg-sky-100 transition duration-150 font-semibold text-sm shadow">
                    </button>
                    <a href="index.html" class="text-sm font-medium text-sky-200 hover:text-white" data-key="logout_link">← Log Out / Portal</a>
                </div>
            </div>
        </header>

        <!-- Patient Key Information & Goals Overview -->
        <section class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Left Column (2/3): My Journey -->
                <div class="lg:col-span-2 section-card bg-white/70">
                    <h2 class="text-xl font-bold text-gray-800 mb-4" data-key="journey_title">My Journey</h2>
                    <h3 class="text-2xl font-extrabold text-gray-900 border-b pb-2 text-sky-600" data-key="sec_goals_title_impact">Goals & Motivation</h3>
                    <p class="text-sm text-gray-600 my-4" data-key="goals_motivation_intro">Focus on these goals—they are the powerful symptoms we are working together to eliminate through holistic treatment.</p>
                    <div class="mb-5">
                        <h4 class="font-bold text-gray-700 mb-2" data-key="goals_list_title">My 3 Symptoms to Eliminate:</h4>
                        <ul class="list-disc list-inside text-sm text-sky-700 font-semibold space-y-1 pl-4">
                            <li data-key="goal1">Chronic Daytime Fatigue</li>
                            <li data-key="goal2">Frequent Neck/Shoulder Tension</li>
                            <li data-key="goal3">Waking up with dry mouth</li>
                        </ul>
                    </div>
                    <button class="w-full py-2 bg-gray-100 text-gray-600 rounded-lg hover:bg-gray-200 text-sm font-medium" data-key="btn_update_goals">Update Pains & Goals</button>
                </div>

                <!-- Right Column (1/3): Key Contacts -->
                <div class="lg:col-span-1 section-card border-t-4 border-sky-500">
                    <h2 class="text-xl font-bold text-gray-800 mb-4" data-key="key_contacts_title">Key Contacts & Appointments</h2>
                    <div class="space-y-3 text-sm">
                        <p><strong data-key="patient_name_label">Patient:</strong> <span class="font-semibold">Mr. John Lee</span></p>
                        <p><strong data-key="patient_id_label">Patient ID:</strong> <span class="font-mono text-gray-600">AMDTW001</span></p>
                        <hr class="border-gray-100">
                        <p><strong data-key="dentist_label">Dentist:</strong> Dr. C. Lin (Harmony Clinic)</p>
                        <p><strong data-key="amc_label">AMC:</strong> Jane Chen</p>
                    </div>
                    <hr class="border-gray-100 my-3">
                    <p class="text-xs text-gray-500" data-key="next_appointment_label">Next Appointment:</p>
                    <p class="text-base font-bold text-sky-600 mb-3">Dec 20, 2025 at 10:00 AM</p>
                    <button class="w-full py-2 bg-sky-500 text-white text-sm rounded-lg hover:bg-sky-600 font-medium" data-key="btn_create_appointment">
                        Create New Appointment
                    </button>
                </div>
            </div>
        </section>

        <!-- Main Content Area with Tabs -->
        <main class="max-w-7xl mx-auto pb-8 px-4 sm:px-6 lg:px-8">
            <div class="lg:grid lg:grid-cols-4 lg:gap-8">
                <!-- LEFT COLUMN: Navigation Tabs -->
                <div class="lg:col-span-1 mb-8 lg:mb-0">
                    <div class="bg-white p-4 rounded-xl shadow-lg lg:sticky lg:top-8">
                        <h3 class="text-lg font-bold text-gray-900 mb-4 border-b pb-2" data-key="nav_title">Navigation</h3>
                        <nav class="flex flex-col space-y-2">
                            <button class="tab-button active" onclick="switchTab('my-plan')" data-key="tab_my_plan">
                                My Plan & Support
                            </button>
                            <button class="tab-button" onclick="switchTab('diagnostics')" data-key="tab_diagnostics">
                                Scans, Analysis & Reports
                            </button>
                            <button class="tab-button" onclick="switchTab('questionnaire')" data-key="tab_questionnaire">
                                My Questionnaire
                            </button>
                            <button class="tab-button" onclick="switchTab('progress')" data-key="tab_progress">
                                Progress Tracker
                            </button>
                            <button class="tab-button" onclick="switchTab('chat')" data-key="tab_chat">
                                Secure Group Chat
                            </button>
                        </nav>
                    </div>
                </div>

                <!-- RIGHT COLUMN: Tab Content -->
                <div class="lg:col-span-3 space-y-8">
                    <!-- 1. My Plan & Support Tab -->
                    <div id="tab-my-plan" class="tab-content space-y-8">
                        <div class="section-card">
                            <h2 class="text-2xl font-semibold text-gray-800 mb-4 border-b pb-2 text-yellow-600" data-key="sec_interventions_title">Treatment Interventions</h2>
                            <div class="mb-8 p-6 border rounded-lg bg-yellow-50/50">
                                <h3 class="font-bold text-gray-700 mb-2" data-key="appliance_title">Start Thriving Appliance (TM)</h3>
                                <div class="mb-4">
                                    <p class="text-sm font-semibold text-gray-800" id="app_duration_text" data-key="app_duration_text">Total Prescription: 24 Months</p>
                                    <div class="flex items-center space-x-4 mt-2">
                                        <div class="flex-1">
                                            <div class="w-full h-3 bg-gray-200 rounded-full overflow-hidden">
                                                <div id="appliance-progress-bar-detail" class="h-full bg-sky-500 transition-all duration-500" style="width: 25%;"></div>
                                            </div>
                                        </div>
                                        <span id="appliance-percentage" class="text-base font-extrabold text-sky-700">25%</span>
                                    </div>
                                    <p class="text-xs text-gray-500 mt-1" id="app_remaining_time" data-key="app_remaining_time">You have <span id="appliance-remaining-months">18</span> months remaining.</p>
                                </div>
                                <div class="mb-6 border-t pt-4">
                                    <h4 class="font-bold text-sm text-gray-700 mb-2" data-key="adjustment_timeline_title">View Appliance History (Month: <span id="display-month">6</span>)</h4>
                                    <input type="range" min="0" max="24" value="6" step="1" class="w-full h-2 bg-yellow-200 rounded-lg appearance-none cursor-pointer" id="appliance-timeline-slider" oninput="updateApplianceDetails(this.value)">
                                    <div class="flex justify-between text-xs mt-1 text-gray-500">
                                        <span data-key="app_start">Start</span>
                                        <span data-key="app_24m">24 Months</span>
                                    </div>
                                </div>
                                <div class="p-3 bg-teal-100 border border-teal-300 rounded-lg mb-4">
                                    <p class="font-bold text-teal-800 mb-1" id="dentist-note-title" data-key="dentist_note_title">Dentist Clinical Note (12/01/2025):</p>
                                    <p class="text-sm text-teal-700" id="dentist-note-content">Monitor patient's TMJ discomfort at current expansion rate (0.50mm). Continue myofunctional exercises daily. Next checkup scheduled for Month 8.</p>
                                </div>
                                <div id="adjustment-list" class="space-y-2 text-sm text-gray-600 p-3 bg-yellow-100 rounded-lg">
                                    <p><strong data-key="adj_setting_label">Setting:</strong> <span id="adj-setting-value">2.0 Turns / 0.50mm Expansion</span></p>
                                    <p><strong data-key="adj_date_label">Last Adjusted:</strong> <span id="adj-date-value">15/11/2025</span></p>
                                    <p class="text-xs text-gray-500" id="adj-note-label" data-key="adj_note_label">Note: Active expansion phase. Monitor midline spacing.</p>
                                </div>
                                <button class="mt-4 py-2 px-4 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 text-sm font-medium w-full" data-key="btn_request_adjustment">Request Appliance Adjustment / View History</button>
                            </div>
                            <div class="p-4 border rounded-lg bg-teal-50/50">
                                <h3 class="font-bold text-gray-700 mb-2" data-key="nutrition_title">Prescribed Nutrition Focus:</h3>
                                <ul class="list-disc list-inside text-sm text-gray-600 space-y-1 pl-4 mb-3">
                                    <li data-key="nut_bonebroth">Increase intake of bone broth for collagen support.</li>
                                    <li data-key="nut_calcium">Ensure adequate calcium and magnesium levels.</li>
                                    <li data-key="nut_fattyacids">Focus on essential fatty acids (Omega-3).</li>
                                </ul>
                                <button class="w-full py-2 bg-indigo-500 text-white font-medium rounded-lg hover:bg-indigo-600 transition duration-150" data-key="btn_order_supplements">
                                    Order Supplements Now
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- 2. Diagnostic Inputs Tab (Revised) -->
                    <div id="tab-diagnostics" class="tab-content space-y-8 hidden">
                        <div class="section-card">
                            <h2 class="text-2xl font-semibold text-gray-800 mb-6 border-b pb-2 text-indigo-600" data-key="sec_diagnostics_title_new">Scans, Analysis & Reports</h2>
                            
                            <!-- A. SCANS -->
                            <div class="mb-8">
                                <h3 class="text-lg font-bold text-gray-700 mb-4 border-l-4 border-indigo-500 pl-3" data-key="sub_title_scans">Clinical Imaging & Scans</h3>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <!-- 1. CBCT -->
                                    <div class="border p-4 rounded-lg bg-gray-50 flex items-center justify-between">
                                        <div>
                                            <h4 class="font-bold text-indigo-700 text-sm">CBCT Images</h4>
                                            <p class="text-xs text-gray-500">3D Airway Volumetrics</p>
                                        </div>
                                        <button class="text-xs bg-indigo-100 text-indigo-700 px-3 py-1 rounded hover:bg-indigo-200 font-bold">View</button>
                                    </div>
                                    <!-- 2. Lateral Ceph -->
                                    <div class="border p-4 rounded-lg bg-gray-50 flex items-center justify-between">
                                        <div>
                                            <h4 class="font-bold text-indigo-700 text-sm">Lateral Ceph X-ray</h4>
                                            <p class="text-xs text-gray-500">Skeletal Profiling</p>
                                        </div>
                                        <button class="text-xs bg-indigo-100 text-indigo-700 px-3 py-1 rounded hover:bg-indigo-200 font-bold">View</button>
                                    </div>
                                    <!-- 3. Intra-Oral -->
                                    <div class="border p-4 rounded-lg bg-gray-50 flex items-center justify-between">
                                        <div>
                                            <h4 class="font-bold text-indigo-700 text-sm">3D Intra-Oral Scan</h4>
                                            <p class="text-xs text-gray-500">Digital Teeth Imprint</p>
                                        </div>
                                        <button class="text-xs bg-indigo-100 text-indigo-700 px-3 py-1 rounded hover:bg-indigo-200 font-bold">View</button>
                                    </div>
                                    <!-- 4. Photos -->
                                    <div class="border p-4 rounded-lg bg-gray-50 flex items-center justify-between">
                                        <div>
                                            <h4 class="font-bold text-indigo-700 text-sm">Clinical Photos</h4>
                                            <p class="text-xs text-gray-500">Teeth / Jaw / Posture</p>
                                        </div>
                                        <button class="text-xs bg-indigo-100 text-indigo-700 px-3 py-1 rounded hover:bg-indigo-200 font-bold">View</button>
                                    </div>
                                </div>
                            </div>

                            <!-- B. ANALYSIS -->
                            <div class="mb-8">
                                <h3 class="text-lg font-bold text-gray-700 mb-4 border-l-4 border-amber-500 pl-3" data-key="sub_title_analysis">Expert Analysis</h3>
                                <div class="bg-amber-50 p-4 rounded-lg border border-amber-100">
                                    <p class="text-sm text-gray-800 mb-2"><strong>Sassouni Plus & Schwartz Analysis:</strong></p>
                                    <p class="text-xs text-gray-600 leading-relaxed" data-key="analysis_desc">
                                        Your specialist utilizes advanced cephalometric tracing (Sassouni Plus) to determine the precise skeletal relationship between your jaw and airway. The Schwartz analysis measures your dental arch width against your biological ideal, highlighting constriction that limits tongue space. Together, these form the blueprint for your "Cage" expansion.
                                    </p>
                                    <div class="mt-4 pt-4 border-t border-amber-200">
                                        <button class="text-xs font-bold text-amber-700 hover:underline">Download Full Diagnostic Report (PDF)</button>
                                    </div>
                                </div>
                            </div>

                            <!-- C. REPORTS -->
                            <div>
                                <h3 class="text-lg font-bold text-gray-700 mb-4 border-l-4 border-teal-500 pl-3" data-key="sub_title_reports">Medical Lab Reports</h3>
                                <div class="space-y-2">
                                    <div class="flex justify-between items-center p-3 border rounded-lg hover:bg-gray-50">
                                        <span class="text-sm font-medium text-gray-700">Blood Panel (Complete Blood Count)</span>
                                        <span class="text-xs text-green-600 font-bold">Normal</span>
                                    </div>
                                    <div class="flex justify-between items-center p-3 border rounded-lg hover:bg-gray-50">
                                        <span class="text-sm font-medium text-gray-700">Liver Function Test</span>
                                        <span class="text-xs text-green-600 font-bold">Normal</span>
                                    </div>
                                    <div class="flex justify-between items-center p-3 border rounded-lg hover:bg-gray-50">
                                        <span class="text-sm font-medium text-gray-700">Kidney Function Test</span>
                                        <span class="text-xs text-green-600 font-bold">Normal</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 3. My Questionnaire Tab (NEW) -->
                    <div id="tab-questionnaire" class="tab-content space-y-8 hidden">
                        <div class="section-card">
                            <h2 class="text-2xl font-semibold text-gray-800 mb-6 border-b pb-2 text-purple-600" data-key="tab_questionnaire_title">My Symptom Assessment</h2>
                            <div class="bg-purple-50 p-4 rounded-lg mb-6 border border-purple-100">
                                <p class="text-sm text-purple-900" data-key="questionnaire_summary">
                                    This record reflects your baseline health status at the start of treatment (Date: 2025/11/15).
                                </p>
                            </div>
                            
                            <div class="space-y-6">
                                <!-- Group 1 -->
                                <div>
                                    <h4 class="font-bold text-gray-700 mb-2">Head, Neck & ENT</h4>
                                    <ul class="list-disc list-inside text-sm text-gray-600 pl-4">
                                        <li>Headache/migraine: <span class="font-bold text-red-500">3 (Frequent)</span></li>
                                        <li>Snoring/mouth breathing: <span class="font-bold text-red-500">4 (Severe)</span></li>
                                        <li>TMJ clicking: <span class="font-bold text-orange-500">2 (Occasional)</span></li>
                                    </ul>
                                </div>
                                <!-- Group 2 -->
                                <div>
                                    <h4 class="font-bold text-gray-700 mb-2">Brain & Emotions</h4>
                                    <ul class="list-disc list-inside text-sm text-gray-600 pl-4">
                                        <li>Fatigue/weakness: <span class="font-bold text-red-500">4 (Severe)</span></li>
                                        <li>Brain fog: <span class="font-bold text-red-500">3 (Frequent)</span></li>
                                        <li>Anxiety: <span class="font-bold text-green-600">1 (Mild)</span></li>
                                    </ul>
                                </div>
                                <!-- Medical History -->
                                <div>
                                    <h4 class="font-bold text-gray-700 mb-2">Medical History Noted</h4>
                                    <div class="flex gap-2 flex-wrap">
                                        <span class="px-2 py-1 bg-gray-100 rounded text-xs text-gray-700">High Blood Pressure (Family)</span>
                                        <span class="px-2 py-1 bg-gray-100 rounded text-xs text-gray-700">Thyroid Disorders (Self)</span>
                                    </div>
                                </div>
                            </div>
                            <button class="mt-6 text-sm text-purple-600 font-bold hover:underline">View Full Questionnaire PDF</button>
                        </div>
                    </div>

                    <!-- 4. Progress Tracker Tab -->
                    <div id="tab-progress" class="tab-content space-y-8 hidden">
                        <div class="section-card">
                            <h2 class="text-2xl font-semibold text-gray-800 mb-6 border-b pb-2 text-sky-600" data-key="progress_title">Progress Photo Timeline</h2>
                            
                            <!-- Integrated Progress Metrics -->
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                                <div class="metric-card border-l-4 border-yellow-500">
                                    <p class="text-xs text-gray-500" data-key="metric_jaw_size">Jaw Width Increase (Intermolar):</p>
                                    <p class="text-lg font-bold text-gray-800 mt-1"><span id="metric-jaw-current">42.5mm</span></p>
                                    <p class="text-xs text-gray-600" data-key="metric_start_target">Start: 40.0mm | Target: 45.0mm</p>
                                </div>
                                <div class="metric-card border-l-4 border-teal-500">
                                    <p class="text-xs text-gray-500" data-key="metric_airway">Airway Patency (MCS):</p>
                                    <p class="text-lg font-bold text-gray-800 mt-1"><span id="metric-airway-current">305 mm²</span></p>
                                    <p class="text-xs text-gray-600" data-key="metric_start_target_airway">Start: 285 mm² | Target: >320 mm²</p>
                                </div>
                                <div class="metric-card border-l-4 border-indigo-500">
                                    <p class="text-xs text-gray-500" data-key="metric_sleep_score">Sleep Symptom Score (MSQ):</p>
                                    <p class="text-lg font-bold text-green-600 mt-1"><span id="metric-sleep-current">18 <span class="text-sm text-gray-500" data-key="score_change_text">(↓ -7)</span></span></p>
                                    <p class="text-xs text-gray-600" data-key="metric_start_target_sleep">Start: 25 | Target: < 5</p>
                                </div>
                            </div>

                            <!-- SHARE YOUR JOURNEY BANNER -->
                            <div class="share-banner p-6 rounded-2xl text-white flex flex-col md:flex-row justify-between items-center gap-4 mb-8 shadow-lg">
                                <div>
                                    <h3 class="text-xl font-bold mb-1" data-key="advocate_title">You are an Airway Advocate.</h3>
                                    <p class="text-sm opacity-90" data-key="advocate_desc">Share your progress with the community and inspire the revolution.</p>
                                </div>
                                <button onclick="openShareModal()" class="px-8 py-3 bg-white text-sky-600 rounded-xl font-black text-xs uppercase shadow-xl hover:scale-105 transition-all">
                                    <i class="fa-solid fa-share-nodes mr-2"></i> <span data-key="advocate_btn">Share Your Journey</span>
                                </button>
                            </div>

                            <p class="text-sm text-gray-500 mb-4" data-key="progress_subtitle">Track your jaw and posture changes over the 18-month growth prescription period.</p>
                            <h3 class="font-bold text-gray-700 mb-4" data-key="comparison_view_title">Historical Comparison View</h3>
                            <div class="bg-gray-100 p-4 rounded-lg mb-4">
                                <label for="comparison-slider" id="comparison-label" class="block text-sm font-medium text-gray-700 mb-2" data-key="viewing_photos">Viewing photos from: Month 6 Check</label>
                                <input type="range" min="0" max="4" value="0" step="1" class="w-full h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer" id="comparison-slider" oninput="updateComparisonView(this.value)">
                                <div class="flex justify-between text-xs mt-1 text-gray-500">
                                    <span data-key="comp_c0">Initial</span><span data-key="comp_c1">Month 3</span><span data-key="comp_c2">Month 6</span><span data-key="comp_c3">Month 12</span><span data-key="comp_c4">Current</span>
                                </div>
                            </div>
                            <div id="photo-comparison-grid" class="grid grid-cols-2 md:grid-cols-4 gap-4"></div>
                            <button class="mt-6 w-full py-2 bg-sky-500 text-white rounded-lg hover:bg-sky-600 text-sm font-medium" data-key="upload_photo">Upload New Progress Photo</button>
                        </div>
                    </div>

                    <!-- 5. Secure Group Chat Tab -->
                    <div id="tab-chat" class="tab-content space-y-8 hidden">
                         <div class="section-card">
                            <h2 class="text-2xl font-semibold text-gray-800 mb-4 border-b pb-2 text-blue-600" data-key="sec_chat_title">Secure Group Chat</h2>
                            <div class="h-80 overflow-y-auto p-4 border rounded-lg bg-gray-50 flex flex-col space-y-3">
                                <div class="p-3 rounded-xl max-w-[80%] chat-doctor shadow-sm">
                                    <p class="text-xs font-semibold text-teal-800">Dr. Smith</p>
                                    <p class="text-sm text-gray-800 mt-1">Hello, I have reviewed your latest CBCT. Please ensure consistent wear-time.</p>
                                </div>
                                <div class="p-3 rounded-xl max-w-[80%] bg-blue-100 shadow-sm self-end">
                                    <p class="text-xs font-semibold text-blue-800">You</p>
                                    <p class="text-sm text-gray-800 mt-1">Understood, Dr. Smith.</p>
                                </div>
                            </div>
                            <div class="mt-4 flex space-x-2">
                                <input type="text" class="flex-grow p-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-blue-500" placeholder="Type your message...">
                                <button class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium" data-key="btn_send">Send</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- SHARE MODAL -->
    <div id="share-modal" class="fixed inset-0 bg-slate-900/60 backdrop-blur-sm flex items-center justify-center z-50 hidden p-4">
        <div class="bg-white w-full max-w-lg p-8 rounded-2xl shadow-2xl">
            <div class="flex justify-between items-center mb-6 border-b pb-2">
                <h3 class="text-xl font-black text-slate-900 uppercase tracking-tight" data-key="modal_share_title">Share Your Milestone</h3>
                <button onclick="closeShareModal()" class="text-slate-400 hover:text-slate-600"><i class="fa-solid fa-times text-xl"></i></button>
            </div>
            
            <p class="text-sm font-bold text-slate-500 uppercase tracking-widest mb-4" data-key="select_platforms">1. Select Platforms</p>
            <div class="grid grid-cols-4 gap-4 mb-8">
                <div class="platform-btn" onclick="togglePlatform(this, 'ig')">
                    <i class="fa-brands fa-instagram text-2xl text-pink-600 mb-1"></i>
                    <span class="text-[10px] font-bold uppercase">Instagram</span>
                </div>
                <div class="platform-btn" onclick="togglePlatform(this, 'tt')">
                    <i class="fa-brands fa-tiktok text-2xl text-slate-900 mb-1"></i>
                    <span class="text-[10px] font-bold uppercase">TikTok</span>
                </div>
                <div class="platform-btn" onclick="togglePlatform(this, 'fb')">
                    <i class="fa-brands fa-facebook text-2xl text-blue-600 mb-1"></i>
                    <span class="text-[10px] font-bold uppercase">Facebook</span>
                </div>
                <div class="platform-btn" onclick="togglePlatform(this, 'ln')">
                    <i class="fa-brands fa-line text-2xl text-green-500 mb-1"></i>
                    <span class="text-[10px] font-bold uppercase">Line</span>
                </div>
            </div>

            <p class="text-sm font-bold text-slate-500 uppercase tracking-widest mb-4" data-key="select_metrics">2. Select Metrics to Share</p>
            <div class="space-y-3 mb-8">
                <label class="flex items-center gap-3 p-3 border rounded-xl hover:bg-slate-50 cursor-pointer">
                    <input type="checkbox" checked class="h-4 w-4 text-sky-600 rounded">
                    <span class="text-xs font-semibold text-slate-700" data-key="metric_jaw_label">Jaw Width Expansion (+2.5mm)</span>
                </label>
                <label class="flex items-center gap-3 p-3 border rounded-xl hover:bg-slate-50 cursor-pointer">
                    <input type="checkbox" checked class="h-4 w-4 text-sky-600 rounded">
                    <span class="text-xs font-semibold text-slate-700" data-key="metric_airway_label">Airway Volume Gain (+20mm²)</span>
                </label>
                <label class="flex items-center gap-3 p-3 border rounded-xl hover:bg-slate-50 cursor-pointer">
                    <input type="checkbox" class="h-4 w-4 text-sky-600 rounded">
                    <span class="text-xs font-semibold text-slate-700" data-key="metric_photos_label">Progress Photos (Profile Change)</span>
                </label>
            </div>

            <button onclick="handleShare()" class="w-full py-4 bg-sky-600 text-white rounded-xl font-black text-xs uppercase shadow-xl hover:bg-sky-700 transition-all">
                <i class="fa-solid fa-cloud-arrow-up mr-2"></i> <span data-key="final_share_btn">Generate & Share Milestone</span>
            </button>
        </div>
    </div>

    <script>
        let currentLang = 'en'; 
        const monthsCompleted = 6;
        const totalPrescriptionMonths = 24;
        const percentageCompleted = Math.round((monthsCompleted / totalPrescriptionMonths) * 100);

        const applianceAdjustments = [
            { month: 0, expansion: '0.0mm', date: '2025/09/20', note: 'Baseline fit.' },
            { month: 6, expansion: '2.0 Turns / 0.50mm', date: '2026/03/20', note: 'Active phase.' }
        ];

        const translations = {
            'en': {
                'header_title': 'AMD Client Dashboard',
                'logout_link': '← Log Out / Portal',
                'journey_title': 'My Journey',
                'key_contacts_title': 'Key Contacts & Appointments',
                'nav_title': 'Navigation',
                'tab_my_plan': 'My Plan & Support',
                'tab_diagnostics': 'Scans, Analysis & Reports',
                'tab_questionnaire': 'My Questionnaire',
                'tab_progress': 'Progress Tracker',
                'tab_chat': 'Secure Group Chat',
                'sec_goals_title_impact': 'Goals & Motivation',
                'goals_motivation_intro': 'Focus on these goals—they are the symptoms we are eliminating.',
                'goals_list_title': 'My 3 Symptoms to Eliminate:',
                'goal1': 'Chronic Daytime Fatigue',
                'goal2': 'Frequent Neck/Shoulder Tension',
                'goal3': 'Waking up with dry mouth',
                'btn_update_goals': 'Update Pains & Goals',
                'sec_interventions_title': 'Treatment Interventions',
                'appliance_title': 'Start Thriving Appliance (TM)',
                'app_duration_text': 'Total Prescription: 24 Months',
                'app_remaining_time': 'You have 18 months remaining.',
                'dentist_note_title': 'Dentist Clinical Note:',
                'adjustment_timeline_title': 'View Appliance History',
                'btn_request_adjustment': 'Request Appliance Adjustment',
                'nutrition_title': 'Prescribed Nutrition Focus:',
                'btn_order_supplements': 'Order Supplements Now',
                'sec_amc_support_title': 'AMC & Support',
                'amc_coordinator_title': 'Assigned Coordinator: Jane Chen (AMC)',
                'btn_arrange_appointment': 'Arrange AMC Appointment',
                'sec_diagnostics_title_new': 'Scans, Analysis & Reports',
                'sub_title_scans': 'Clinical Imaging & Scans',
                'sub_title_analysis': 'Expert Analysis',
                'sub_title_reports': 'Medical Lab Reports',
                'analysis_desc': 'Your specialist utilizes advanced cephalometric tracing (Sassouni Plus) to determine the precise skeletal relationship between your jaw and airway. The Schwartz analysis measures your dental arch width against your biological ideal.',
                'tab_questionnaire_title': 'My Symptom Assessment',
                'questionnaire_summary': 'This record reflects your baseline health status at the start of treatment (Date: 2025/11/15).',
                'progress_title': 'Progress Photo Timeline',
                'metric_jaw_size': 'Jaw Width Increase:',
                'metric_airway': 'Airway Patency (MCS):',
                'metric_sleep_score': 'Sleep Score (MSQ):',
                'advocate_title': 'You are an Airway Advocate.',
                'advocate_desc': 'Share your progress with the community and inspire the revolution.',
                'advocate_btn': 'Share Your Journey',
                'modal_share_title': 'Share Your Milestone',
                'select_platforms': '1. Select Platforms',
                'select_metrics': '2. Select Metrics to Share',
                'metric_jaw_label': 'Jaw Width Expansion (+2.5mm)',
                'metric_airway_label': 'Airway Volume Gain (+20mm²)',
                'metric_photos_label': 'Progress Photos (Profile Change)',
                'final_share_btn': 'Generate & Share Milestone',
                'toggle_text': '中文'
            },
            'zh': {
                'header_title': 'AMD 客戶儀表板',
                'logout_link': '← 登出 / 入口網站',
                'journey_title': '我的旅程',
                'key_contacts_title:': '關鍵聯絡人與預約',
                'nav_title': '導航',
                'tab_my_plan': '我的計劃與支持',
                'tab_diagnostics': '掃描、分析與報告',
                'tab_questionnaire': '我的問卷',
                'tab_progress': '進度追踪器',
                'tab_chat': '安全群組聊天',
                'sec_goals_title_impact': '我的旅程：目標與動力',
                'goals_motivation_intro': '專注於這些目標—它們是我們正在努力消除的症狀。',
                'goals_list_title': '我的 3 個欲消除症狀:',
                'goal1': '慢性白天疲勞',
                'goal2': '頻繁頸部/肩部緊張',
                'goal3': '醒來時口乾',
                'btn_update_goals': '更新疼痛與目標',
                'sec_interventions_title': '治療干預措施',
                'appliance_title': '開始興盛矯治器 (TM)',
                'app_duration_text': '總處方期: 24 個月',
                'app_remaining_time': '您還有 18 個月剩餘。',
                'dentist_note_title': '牙醫臨床備註:',
                'adjustment_timeline_title': '查看矯治器歷史',
                'btn_request_adjustment': '請求矯治器調整',
                'nutrition_title': '處方營養重點:',
                'btn_order_supplements': '立即訂購補充劑',
                'sec_amc_support_title': 'AMC 與支持',
                'amc_coordinator_title': '指定協調員: Jane Chen (AMC)',
                'btn_arrange_appointment': '安排 AMC 預約',
                'sec_diagnostics_title_new': '掃描、分析與報告',
                'sub_title_scans': '臨床影像與掃描',
                'sub_title_analysis': '專家分析',
                'sub_title_reports': '醫療檢驗報告',
                'analysis_desc': '您的專家利用先進的頭影測量 (Sassouni Plus) 來確定您的顎骨和氣道之間的精確骨骼關係。Schwartz 分析測量您的牙弓寬度與生物理想值的差距。',
                'tab_questionnaire_title': '我的症狀評估',
                'questionnaire_summary': '此記錄反映了您在治療開始時（日期：2025/11/15）的基準健康狀況。',
                'progress_title': '進度照片追踪器',
                'metric_jaw_size': '下巴寬度增加:',
                'metric_airway': '氣道暢通度 (MCS):',
                'metric_sleep_score': '睡眠症狀分數 (MSQ):',
                'advocate_title': '您是氣道倡導者',
                'advocate_desc': '加入台灣 1,200 多名優化者的行列，分享您的進步。',
                'advocate_btn': '分享您的旅程',
                'modal_share_title': '分享您的里程碑',
                'select_platforms': '1. 選擇平台',
                'select_metrics': '2. 選擇分享數據',
                'metric_jaw_label': '下顎寬度擴張 (+2.5mm)',
                'metric_airway_label': '氣道容量增加 (+20mm²)',
                'metric_photos_label': '進度照片 (側面輪廓變化)',
                'final_share_btn': '生成並分享里程碑',
                'toggle_text': 'English'
            }
        };

        function toggleLanguage() {
            currentLang = currentLang === 'en' ? 'zh' : 'en';
            updateText();
        }

        function switchTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(c => c.classList.add('hidden'));
            document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
            document.getElementById('tab-' + tabId).classList.remove('hidden');
            document.querySelector(`[onclick="switchTab('${tabId}')"]`).classList.add('active');
        }

        function openShareModal() {
            document.getElementById('share-modal').classList.remove('hidden');
        }

        function closeShareModal() {
            document.getElementById('share-modal').classList.add('hidden');
        }

        function togglePlatform(el, platform) {
            el.classList.toggle('selected');
        }

        function handleShare() {
            alert(currentLang === 'en' ? "Milestone Card Generated! Redirecting to sharing platform..." : "里程碑卡已生成！正在轉向分享平台...");
            closeShareModal();
        }

        function updateText() {
            const data = translations[currentLang];
            document.querySelectorAll('[data-key]').forEach(el => {
                const key = el.getAttribute('data-key');
                if (data[key]) el.textContent = data[key];
            });
            document.getElementById('lang-toggle').textContent = data.toggle_text;
        }

        document.addEventListener('DOMContentLoaded', updateText);
    </script>
</body>
</html>
